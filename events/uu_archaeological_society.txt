namespace = archaeological_society

## Launch event. Triggered as soon as the first precursor is found.
country_event = {
	id = archaeological_society.1
	hide_window = yes
	
	trigger = {
		is_country_type = default
		has_country_flag = precursors_found
		NOT = { has_country_flag = archaeological_society_founded }
	}
	
	immediate = {
		set_country_flag = archaeological_society_founded
		country_event = { id = archaeological_society.2 days = 360 }
	}
}

country_event = {
	id = archaeological_society.2
	title = archaeological_society.2.title
	desc = archaeological_society.2.desc
	picture = GFX_evt_archaeological_dig
	
	is_triggered_only = yes
	
	option = {
		name = archaeological_society.2.a
		add_modifier = {
			modifier = archaeological_society
			days = -1
		}
	}
}



#### Archaeological Digs

## Gate Keeper for all the digs loop
country_event = {
	id = archaeological_society.100
	hide_window = yes
	
	trigger = {
		has_country_flag = archaeological_society_founded
		has_modifier = archaeological_society
		NOT = { has_country_flag = dig_loop_fired }
	}
	
	immediate = {
		set_country_flag = dig_loop_fired
		country_event = { id = archaeological_society.101 }
	}
}

## Decides when the next dig will happen and if there will be any digs anymore
country_event = {
	id =  archaeological_society.101
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate  = {
		if = {
			limit = {
				NOT = {
					has_country_flag = takmahl_completed				
				}
			}
			random_list = {
				1 = { country_event = { id = archaeological_society.110 days = 360 } } # 1 year
				1 = { country_event = { id = archaeological_society.110 days = 720 } } # 2 years
				1 = { country_event = { id = archaeological_society.110 days = 1080 } } # 3 years
			}
			country_event = { id = archaeological_society.101 days = 1800 random = 360 } # 5 years
			else = {
				## No more digs
				country_event = { id = archaeological_society.199 }
			}
		}
	}
}

## Decides what precursor to dig for. 
country_event = {
	id = archaeological_society.110
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			100 = {
				if = {
					limit = {
						AND = {
							any_owned_planet = {
								closest_system = {
									has_star_flag = precursor_takmahl
								}
							}
							has_country_flag = takmahl_intro
							NOT = { has_country_flag = takmahl_completed }
						}	
					}
					country_event = { id = archaeological_society.200 }
				}
			}
		}
	}
}

country_event = {
	id = archaeological_society.198
	title = archaeological_society.198.title
	desc = archaeological_society.198.desc
	picture = GFX_evt_archaeological_dig
	
	is_triggered_only = yes
	
	option = {
		name = UNFORTUNATE
	}
}

country_event = {
	id = archaeological_society.199
	title = archaeological_society.199.title
	desc = archaeological_society.199.desc
	picture = GFX_evt_archaeological_dig
	
	is_triggered_only = yes
	
	option = {
		name = OK
		remove_modifier = archaeological_society
	}
}


##################################################################
## Takmahl Events 200+
##################################################################

## Informs player that an archaeological dig is under way.
country_event = {
	id = archaeological_society.200
	title = archaeological_society.200.title
	desc = archaeological_society.200.desc
	picture = GFX_evt_archaeological_dig
	
	is_triggered_only = yes
	
	option = {
		name = OK
		hidden_effect = {
			country_event = { id = archaeological_society.201 days = 60 random = 60 }
		}
	}
}

## What type of planet we should dig on
country_event = {
	id = archaeological_society.201
	hide_window = yes
	
	is_triggered_only = yes
	
	
	immediate = {
		random_list = {
			100 = { 	# habitable planets
				modifier = {
					factor = 0
					AND = {
						has_country_flag = takmahl_historical_records_completed
						has_country_flag = takmahl_cultural_artifacts_completed
						has_country_flag = takmahl_bio_engineering_research_data_completed
						has_country_flag = takmahl_cybernetic_research_data_completed
					}
				}
				country_event = { id = archaeological_society.210 }
			} 
			100 = {  	# barren worlds
				modifier = {
					factor = 0
					has_country_flag = takmahl_terraforming_equipment_completed
				}
				country_event = { id = archaeological_society.220 }
			} 
			100 = { 	# uninhabitable worlds
				modifier = {
					factor = 0
					has_country_flag = takmahl_ship_remnants_completed
				}
				country_event = { id = archaeological_society.230 }
			} 
			1 = { country_event = { id = archaeological_society.198 } }
		}
	}
}


## Choose habitable planet in empire
country_event = {
	id = archaeological_society.210 
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_owned_planet = {
			limit = {
				AND = {
					OR = {
						is_planet_class = pc_arctic
						is_planet_class = pc_continental
						is_planet_class = pc_tropical
						is_planet_class = pc_arid
						is_planet_class = pc_desert
						is_planet_class = pc_tundra
						is_planet_class = pc_ocean
					}
					NOT = { owner = { has_country_flag = recent_archaeological_dig } }
				}
			}
			planet_event = { id = archaeological_society.290 }
		}
	}
}

country_event = {
	id = archaeological_society.220
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_owned_planet = {
			limit = {
				AND = {
					is_planet_class = pc_barren
					NOT = { owner = { has_country_flag = recent_archaeological_dig } }
				}
			}
			planet_event = { id = archaeological_society.291 }
		}
	}
}

country_event = {
	id = archaeological_society.230
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_owned_planet = {
			limit = {
				AND = {
					OR = {
						is_planet_class = pc_molten
						is_planet_class = pc_asteroid
						is_planet_class = pc_gas_giant
						is_planet_class = pc_toxic
					}
					NOT = { owner = { has_country_flag = recent_archaeological_dig } }
				}
			}
			planet_event = { id = archaeological_society.292 }
		}
	}
}

planet_event = {
	id = archaeological_society.290
	title = archaeological_society.290.title
	desc = archaeological_society.290.desc
	picture = GFX_evt_archaeological_dig
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = OK
		hidden_effect = {
			planet_event = { id = takmahl.50 days = 60 }
		}
	}
}

planet_event = {
	id = archaeological_society.291
	title = archaeological_society.291.title
	desc = archaeological_society.291.desc
	picture = GFX_evt_archaeological_dig
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = OK
		hidden_effect = {
			planet_event = { id = takmahl.51 days = 60 }
		}
	}
}

planet_event = {
	id = archaeological_society.292
	title = archaeological_society.292.title
	desc = archaeological_society.292.desc
	picture = GFX_evt_archaeological_dig
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = OK
		hidden_effect = {
			planet_event = { id = takmahl.52 days = 60 }
		}
	}
}

























